<div class="top">
  <div class="left">
    <button mat-raised-button color="primary" (click)="imageInput.click()">
      Upload Image
    </button>
    <mat-form-field appearance="fill" class="full-width">
      <mat-label>Zoom</mat-label>
      <input matInput type="text" [(ngModel)]="zoom" />
    </mat-form-field>
  </div>
  <div class="mid">
    <button mat-raised-button color="primary" (click)="insertPage()">
      Insert Page
    </button>
    <mat-form-field appearance="fill" class="full-width">
      <mat-label>Name</mat-label>
      <input matInput type="text" [(ngModel)]="currentPageName" />
    </mat-form-field>

    <button
      mat-raised-button
      color="primary"
      (click)="left()"
      [disabled]="storyMakerService.currentPageIndex <= 0"
    >
      Left
    </button>
    <span>{{ storyMakerService.currentPageIndex + 1 }}</span>
    <button
      mat-raised-button
      color="primary"
      (click)="right()"
      [disabled]="
        storyMakerService.currentPageIndex >= storyMakerService.pageCount - 1
      "
    >
      Right
    </button>
  </div>
  <div>
    <button mat-raised-button color="primary" (click)="savePositions()">
      Save
    </button>

    <button mat-raised-button color="primary" (click)="exportData()">
      Export JSON
    </button>

    <input
      type="file"
      (change)="importData($event)"
      accept=".json"
      hidden
      #fileInput
    />
    <button mat-raised-button color="primary" (click)="fileInput.click()">
      Import JSON
    </button>

    <input type="file" (change)="uploadImage($event)" hidden #imageInput />
  </div>
</div>
<div class="container-container">
  <div
    class="container"
    #container
    [ngStyle]="{
      width: width,
      height: height,
      'background-image': mapFile,
      zoom: zoom
    }"
  >
    @for (name of keys; track name) {
    <div
      class="icon"
      cdkDrag
      [cdkDragFreeDragPosition]="{
        x: pageCharacters[name].x,
        y: pageCharacters[name].y
      }"
      (cdkDragEnded)="onDragEnd($event, pageCharacters[name])"
      [cdkDragBoundary]="'.container'"
      [cdkDragScale]="zoom"
      (contextmenu)="onIconRightClick($event, name)"
    >
      <i [class]="getCharacter(name).iconClass" [matTooltip]="name"></i>
    </div>
    }
  </div>
</div>
<div class="bottom">
  <div>
    @for(char of remainingCharacters; track char.name) {
    <span (click)="onIconLeftClick(char.name)">
      <span>{{ char.name }}</span>
      <i [class]="char.iconClass" [matTooltip]="char.name"></i
    ></span>
    }
  </div>
  <div>
    <mat-form-field appearance="fill" class="full-width">
      <mat-label>Name</mat-label>
      <input matInput type="text" [formControl]="nameControl" />
    </mat-form-field>
    <mat-form-field appearance="fill" class="full-width">
      <mat-label>Icon</mat-label>
      <mat-select [formControl]="iconControl">
        @for (icon of images; track icon) {
        <mat-option [value]="icon.value">
          <i [class]="icon.value"></i>
          {{ icon.name }}
        </mat-option>
        }
      </mat-select>
    </mat-form-field>
    <button mat-raised-button color="primary" (click)="addIconToPage()">
      Add Icon
    </button>
  </div>
</div>
<div class="bottom">
  <h3>Pro tips</h3>
  <p>
    Right click to remove from map. Left click the remaining icons under map to
    add back to map.
  </p>
  <p>
    You should export json occasionally for backups since save is just local
    storage.
  </p>
  <p>
    Can change size of view by modifying height and width in the JSON (Do this
    before adding icons, since icons are just placed at pixel coordinates).
  </p>
  <p>
    If you need to start over google 'How to clear local storage [insert your
    browser here]'.
  </p>
</div>
